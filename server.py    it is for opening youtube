import socket
import webbrowser
import requests
from googleapiclient.discovery import build
API_KEY="AIzaSyCgrN8iVmyt_BRbbi76UD3IiYK9tCK_FC0"
YOUTUBE_API_SERVICE_NAME = "youtube"
YOUTUBE_API_VERSION = "v3"
BASE_URL="https://youtube.com/watch?v="
server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.bind(("127.0.0.1", 5556))
server.listen()
conn, addr = server.accept()
print("Conneced with client....", addr)
data = conn.recv(1024).decode().strip()
def search_song(query, max_results=5):
    youtube = build(YOUTUBE_API_SERVICE_NAME, YOUTUBE_API_VERSION, developerKey=API_KEY)
    request = youtube.search().list(
        q=query,
        part="snippet",
        type="video",
        maxResults=max_results
    )
    response = request.execute()
    video_ids = []
    for item in response["items"]:
        song_id = item["id"]["videoId"]
        title = item["snippet"]["title"]
        url = BASE_URL + song_id
        video_ids.append({"title": title, "url": url})
    return video_ids
results = search_song(data)
for res in results:
    print(f"{res['title']} -> {res['url']}")
    print(f"Client says...{data}")
def SendMessage():
    if data != "":
        for res in results:
            print(f"{res['title']} -> {res['url']}\n")
            message = f"{res['title']} -> {res['url']}"
            print(f"Your song is {data}")
            conn.sendall(message.encode())
SendMessage()
conn.close()
server.close()
